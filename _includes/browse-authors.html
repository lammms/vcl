<html>
<style>
.filterDiv {
  float: left;
  background-color: #ffd700;
  color: #ffffff;
  width: 100px;
  line-height: 100px;
  text-align: center;
  margin: 2px;
  display: none;
}

.show {
  display: block;
}

.container {
  margin-top: 20px;
  overflow: hidden;
}

/* Style the buttons */
.btn {
  border: none;
  outline: none;
  padding: 12px 16px;
  background-color: #0c0c0c;
  cursor: pointer;
}

.btn:hover {
  background-color: #ddd;
}

.btn.active {
  background-color: #666;
  color: white;
}
</style>
<body>
	<div class="container">
		<div class="input-group mb-3">
			<input type="text" class="form-control" placeholder="Search for an item in this category">
			<select id="search-dropdown" class="form-select">
				<option selected value="">All</option>
			</select>
		</div>

		<div id="data-container" class="row">
		</div>
	</div>

	<script>
		let datasets = [
			{
				"type" : "authors",
				"url" : "/data/authors.json"
			}
		];

		var dataLinks = [];

		$( document ).ready(function() {
			for (i = 0; i < datasets.length; i++) {
				dataLinks.push({
					"type" : datasets[i].type,
					"data" : siftData(datasets[i].url, datasets[i].type)
				});
			}

			for (i = 0; i < dataLinks.length; i++) {
				$('#search-dropdown').append(`<option value="${dataLinks[i].type}">${dataLinks[i].type}</option>`);
			}

			//Set triggers
			$('#search-dropdown').on('change', function (event) {
				showCategory(event.target.value);
				console.log("Category changed!");
			})

			//Populate page
			showCategory();
		});

		function siftData (url, dataType) {
			var temp = [];

			$.getJSON(url, function (data) {
				switch (dataType) {
					case "authors":
						for (key in data) {
							temp.push({
								"flavorText" : data[key]["Author"],
                                "subtitle" : data[key]["author_country"],
								"link" : data[key]["author_id"]
							});
						}
						break;

					default:
						break;
				}
			});

			return temp;
		}

		function showCategory (category = "", filter = "") {
			$('#data-container').html('');

			dataLinks.forEach(element => {
				if ((category == "" || category == "all") || (element.type == category && element.data.length > 0)) {
					for (i = 0; i < element.data.length; i++) {
						$('#data-container').append(`
							<div class="card col-4">
								<div class="card-body">
									<h5 class="card-title">${element.data[i].flavorText}</h5>
									<h6 class="card-subtitle mb-2 text-muted">${element.data[i].subtitle}</h6>
									<a href="/${element.data[i].link}" class="card-link">More</a>
								</div>
							</div>
						`);
					}
				}
			});
		}
	</script>
</body>
</html>
